name: Sync and Mirror for Classic Repos

on: pull_request
jobs:
  sync-mirrors:
    strategy:
      matrix:
        remote:
          - electronshaders@git.code.sf.net/p/manifestautoupdate/git
          - electron-shaders@git.launchpad.net/~electron-shaders/manifestautoupdate
          - rhodecode@code.rhodecode.com:3022/u/electron-shaders/ManifestAutoUpdate
    runs-on: ubuntu-latest
    steps:
    - name: Checkout upstream repo
      uses: actions/checkout@v4
      with:
        repository: heyong5454/ManifestAutoUpdate
        fetch-depth: 0    

    - name: Push to classic mirror repos
      uses: pixta-dev/repository-mirroring-action@v1
      with:
        target_repo_url: ssh://${{ matrix.remote }}
        ssh_private_key: ${{ secrets.GIT_SSH_PRIVATE_KEY }}
